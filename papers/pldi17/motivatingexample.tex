\section{Background: This Doesnt Belong Here}
\subsection{OSPF}

\subsection{BGP}
BGP is a path-vector routing protocol that connects 
different autonomous systems (ASes), where each AS
comprises of one or more routers (typically managed
by a single entity). 

\minisection{eBGP}
\\
\minisection{iBGP}
Multiple routes received to a dst from domain
iBGP synchs these routes among different routers
and chooses the best route according to \Cref{alg:bgppathrules}.

\minisection{Route Redistribution}
Main point is that routers only redistribute
eBGP routes (and not iBGP routes) into OSPF.
\name uses this to enforce the particular
BGP gateway

\subsection{BGP Best Path Selection Algorithm}
A BGP router receives multiple paths to the destination: (1)
external routes from border routers of neighbouring domains using
eBGP, and (2) routes learned by other BGP routers 
of the domain which are advertised using iBGP. 
BGP decides the best path to install in the 
forwarding table based on different metrics like local preferences,
AS path lengths and type of routes~\cite{bgp}. BGP uses \Cref{alg:bgppathrules}\footnote{
The actual BGP implementation has several other criteria
for choosing best routes, the configurations synthesized
by \name will use the abridged algorithm (which considers
the rules in relative ordering to actual BGP). 
} 
to select the best route 
from the set of received announcements from eBGP 
and iBGP (after applying the configured route filters). 
\begin{algorithm}
	\begin{footnotesize}
		\caption{BGP Best Path Algorithm}
		\label{alg:bgppathrules}
		\begin{algorithmic}[1]
			\State{[Input] $R \leftarrow$ eBGP and iBGP routes for $dst$} 
			\State{[Output] $r_{best}$ : Best BGP route} \newline \newline
			/* Find routes with highest \emph{local preference} */
			\State{$R_{lp} = \{r \in R ~| ~\forall r_1 \in R. ~r.local\_pref \geq r1.local\_pref\}$}
			\If{$|R_{lp}| = 1$}
			\State{$r_{best} = r \in R_{lp}$}
			\Else \newline
			\indent /* Prefer the path with the smallest \emph{AS Path length} */
			\State{$R_{as} = \{r \in R_{lp}  ~|~ \forall r_1 \in R_{lp}. ~r.path\_len \geq r_1.path\_len\} $}
			\If{$|R_{as}| = 1$}
			\State{$r_{best} = r \in R_{as}$}	
			\EndIf
			\EndIf
%				\State{ . }
%				\State{Prefer the path with the lowest \emph{multi-exit discriminator} (MED).}
%				\State{Prefer eBGP over iBGP paths.}
%				\State{Prefer the route that comes from the BGP router with the lowest \emph{router ID}.}
		\end{algorithmic}
	\end{footnotesize}
\end{algorithm}

