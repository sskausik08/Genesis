\section{Introduction}
%[Intro] 
Network operators of enterprise and cloud datacenter networks deal with large number of heterogeneous devices and thousands of traffic classes with increasingly complex policies. However, in real-life, the process of policy enforcement by network operators is manual and ad-hoc, leading to violations of service-level agreements and mis-configurations which have severe performance and security impacts. With the boom in cloud services, datacenter networks deal with thousands of flows which are not constant, but in flux, thus, making it difficult to enforce them in an ad-hoc manner. 

Network operators desire various different end-to-end policies to support in clouds and enterprise networks. Tenants or organisations require support for basic policies like reachability between hosts, and specifying different middlebox policies for certain flows. Operators, on top of that require support for complex policies like traffic isolation between flows to provide fairness and specifying resource constraints like link bandwidth and switch table sizes to perform traffic engineering and network resource management. 

Though Software-defined Networking (SDN) has allowed network operators to program networks in a more intuitive manner, many existing tools are too low-level in their functionality. Support for these policies simply using SDN switches or with existing languages like Frenetic\cite{frenetic} and Pyretic\cite{pyretic} are extremely challenging, and operators would ideally want to specify network-wide end-to-end policies in a declarative manner without programming individual switch behavior. 

There has been research in the field of network-wide policy enforcement in networks, like bandwidth provisioning in Merlin \cite{Merlin}, and middlebox policy enforcement in SIMPLE \cite{simple}. However, the approach followed in these works are tailor-made to  specific policies, and thus, difficult to extend it to support other kinds of policies. To support a cornucopia of policies, an important feature is \emph{generality} of the approach of policy enforcement, so that it can be extended to enforce custom policies required by the operator. To achieve this, we use \emph{synthesis} of switch table forwarding rules to the solve the problem of policy enforcement by use of off-the-shelf SMT-solvers.

 Enforcement of isolation, waypoint policies are NP- complete, so we leverage recent advances in creating fast SMT solvers (like Z3) to perform synthesis by encoding the policy enforcement problem to a SMT instance, and use the SMT solver to find a solution which we translate to switch rules. This paper presents Genesis, a network management tool where the network operators can express the network-wide policies in a high-level declarative manner and Genesis will synthesize the lower-level switch forwarding rules for realising these policies, eliminating the need for operators to work on switch-level behaviours. By using a formal reasoning technique of SAT/SMT solving, we eliminate the room of error in policy enforcement.   

While SMT solvers are fast, the scale of operations of cloud and enterprise networks are huge, and by supporting a set of diverse and complex policies with different search objectives, we require to create a model general and expressive enough to support these. This poses a challenge as to can synthesis performance be improved by leveraging knowledge specific to the problem of policy enforcement in networks? 

The main contribution of this paper are : We present the design and implementation of a network management system with support for a diverse set of complex end-to-end policies like isolation, waypoints and capacity. We designed a novel search strategy using regular expressions to prune the space of forwarding plane configurations by leveraging the network structure to provide properties of the path, especially in datacenter topologies. Lastly, we design a heuristical synthesis routine leveraging the nature of policy interactions to improve synthesis performance.